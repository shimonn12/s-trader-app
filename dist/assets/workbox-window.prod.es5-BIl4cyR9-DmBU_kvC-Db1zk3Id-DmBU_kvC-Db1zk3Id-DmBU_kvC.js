try{self["workbox:window:7.3.0"]&&_()}catch{}function b(t,r){return new Promise((function(n){var i=new MessageChannel;i.port1.onmessage=function(v){n(v.data)},t.postMessage(r,[i.port2])}))}function P(t,r){(r==null||r>t.length)&&(r=t.length);for(var n=0,i=Array(r);n<r;n++)i[n]=t[n];return i}function j(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,W(i.key),i)}}function S(t,r){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=(function(v,c){if(v){if(typeof v=="string")return P(v,c);var a={}.toString.call(v).slice(8,-1);return a==="Object"&&v.constructor&&(a=v.constructor.name),a==="Map"||a==="Set"?Array.from(v):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?P(v,c):void 0}})(t))||r){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(t,r){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},w(t,r)}function W(t){var r=(function(n,i){if(typeof n!="object"||!n)return n;var v=n[Symbol.toPrimitive];if(v!==void 0){var c=v.call(n,i);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)})(t,"string");return typeof r=="symbol"?r:r+""}try{self["workbox:core:7.3.0"]&&_()}catch{}var m=function(){var t=this;this.promise=new Promise((function(r,n){t.resolve=r,t.reject=n}))};function y(t,r){var n=location.href;return new URL(t,n).href===new URL(r,n).href}var d=function(t,r){this.type=t,Object.assign(this,r)};function l(t,r,n){return n?r?r(t):t:(t&&t.then||(t=Promise.resolve(t)),r?t.then(r):t)}function k(){}var L={type:"SKIP_WAITING"};function E(t,r){return t&&t.then?t.then(k):Promise.resolve()}var O=(function(t){function r(c,a){var e,o;return a===void 0&&(a={}),(e=t.call(this)||this).nn={},e.tn=0,e.rn=new m,e.en=new m,e.on=new m,e.un=0,e.an=new Set,e.cn=function(){var u=e.fn,s=u.installing;e.tn>0||!y(s.scriptURL,e.sn.toString())||performance.now()>e.un+6e4?(e.vn=s,u.removeEventListener("updatefound",e.cn)):(e.hn=s,e.an.add(s),e.rn.resolve(s)),++e.tn,s.addEventListener("statechange",e.ln)},e.ln=function(u){var s=e.fn,f=u.target,h=f.state,p=f===e.vn,g={sw:f,isExternal:p,originalEvent:u};!p&&e.mn&&(g.isUpdate=!0),e.dispatchEvent(new d(h,g)),h==="installed"?e.wn=self.setTimeout((function(){h==="installed"&&s.waiting===f&&e.dispatchEvent(new d("waiting",g))}),200):h==="activating"&&(clearTimeout(e.wn),p||e.en.resolve(f))},e.yn=function(u){var s=e.hn,f=s!==navigator.serviceWorker.controller;e.dispatchEvent(new d("controlling",{isExternal:f,originalEvent:u,sw:s,isUpdate:e.mn})),f||e.on.resolve(s)},e.gn=(o=function(u){var s=u.data,f=u.ports,h=u.source;return l(e.getSW(),(function(){e.an.has(h)&&e.dispatchEvent(new d("message",{data:s,originalEvent:u,ports:f,sw:h}))}))},function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];try{return Promise.resolve(o.apply(this,u))}catch(f){return Promise.reject(f)}}),e.sn=c,e.nn=a,navigator.serviceWorker.addEventListener("message",e.gn),e}var n,i;i=t,(n=r).prototype=Object.create(i.prototype),n.prototype.constructor=n,w(n,i);var v=r.prototype;return v.register=function(c){var a=(c===void 0?{}:c).immediate,e=a!==void 0&&a;try{var o=this;return l((function(u,s){var f=u();return f&&f.then?f.then(s):s(f)})((function(){if(!e&&document.readyState!=="complete")return E(new Promise((function(u){return window.addEventListener("load",u)})))}),(function(){return o.mn=!!navigator.serviceWorker.controller,o.dn=o.pn(),l(o.bn(),(function(u){o.fn=u,o.dn&&(o.hn=o.dn,o.en.resolve(o.dn),o.on.resolve(o.dn),o.dn.addEventListener("statechange",o.ln,{once:!0}));var s=o.fn.waiting;return s&&y(s.scriptURL,o.sn.toString())&&(o.hn=s,Promise.resolve().then((function(){o.dispatchEvent(new d("waiting",{sw:s,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.yn),o.fn}))})))}catch(u){return Promise.reject(u)}},v.update=function(){try{return this.fn?l(E(this.fn.update())):l()}catch(c){return Promise.reject(c)}},v.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},v.messageSW=function(c){try{return l(this.getSW(),(function(a){return b(a,c)}))}catch(a){return Promise.reject(a)}},v.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&b(this.fn.waiting,L)},v.pn=function(){var c=navigator.serviceWorker.controller;return c&&y(c.scriptURL,this.sn.toString())?c:void 0},v.bn=function(){try{var c=this;return l((function(a,e){try{var o=a()}catch(u){return e(u)}return o&&o.then?o.then(void 0,e):o})((function(){return l(navigator.serviceWorker.register(c.sn,c.nn),(function(a){return c.un=performance.now(),a}))}),(function(a){throw a})))}catch(a){return Promise.reject(a)}},(function(c,a,e){return a&&j(c.prototype,a),Object.defineProperty(c,"prototype",{writable:!1}),c})(r,[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])})((function(){function t(){this.Pn=new Map}var r=t.prototype;return r.addEventListener=function(n,i){this.jn(n).add(i)},r.removeEventListener=function(n,i){this.jn(n).delete(i)},r.dispatchEvent=function(n){n.target=this;for(var i,v=S(this.jn(n.type));!(i=v()).done;)(0,i.value)(n)},r.jn=function(n){return this.Pn.has(n)||this.Pn.set(n,new Set),this.Pn.get(n)},t})());export{O as Workbox,d as WorkboxEvent,b as messageSW};
